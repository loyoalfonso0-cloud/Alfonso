<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<body>

<!-- Modal Base Reutilizable -->
<div id="modalBase" class="modal" style="display:none;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,0.6);backdrop-filter:blur(4px)">
    <div class="modal-content" style="margin:2% auto;padding:0;border-radius:12px;width:95%;max-width:700px;max-height:95vh;overflow-y:auto;box-shadow:0 20px 40px rgba(0,0,0,0.3)">
        <div class="modal-header" style="padding:16px 20px;border-bottom:1px solid #2a2a3a;display:flex;align-items:center;justify-content:space-between">
            <h3 class="modal-title" style="margin:0;font-size:18px;font-weight:600;color:#e7e7f7">Título del Modal</h3>
            <button class="modal-close" onclick="closeModal()" style="background:none;border:none;color:#a4a4be;font-size:20px;cursor:pointer;padding:0;width:30px;height:30px;border-radius:50%;display:flex;align-items:center;justify-content:center">
                &times;
            </button>
        </div>
        <div class="modal-body" style="padding:20px">
            <!-- Contenido dinámico -->
        </div>
        <div class="modal-footer" style="padding:16px 20px;border-top:1px solid #2a2a3a;display:flex;gap:12px;justify-content:flex-end">
            <button class="btn-secondary" onclick="closeModal()" style="padding:8px 16px;border-radius:6px;border:1px solid #3a3a4a;background:transparent;color:#a4a4be;cursor:pointer;font-size:14px">
                Cancelar
            </button>
            <button class="btn-primary modal-submit" style="padding:8px 20px;border-radius:6px;border:none;background:#6366f1;color:white;cursor:pointer;font-size:14px;font-weight:500">
                Guardar
            </button>
        </div>
    </div>
</div>

<!-- Modal de Confirmación -->
<div id="confirmModal" class="modal" style="display:none;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,0.6);backdrop-filter:blur(4px)">
    <div class="modal-content" style="background:#1e1e2a;margin:15% auto;padding:0;border-radius:12px;width:90%;max-width:400px;box-shadow:0 20px 40px rgba(0,0,0,0.3);border:1px solid #2a2a3a">
        <div class="modal-body" style="padding:24px;text-align:center">
            <div style="font-size:48px;color:#ef4444;margin-bottom:16px">⚠️</div>
            <h3 style="margin:0 0 12px 0;font-size:18px;font-weight:600;color:#e7e7f7">¿Está seguro?</h3>
            <p style="margin:0;color:#a4a4be;line-height:1.5">Esta acción no se puede deshacer.</p>
        </div>
        <div class="modal-footer" style="padding:16px 24px;border-top:1px solid #2a2a3a;display:flex;gap:12px;justify-content:center">
            <button class="btn-secondary" onclick="closeConfirmModal()" style="padding:8px 20px;border-radius:6px;border:1px solid #3a3a4a;background:transparent;color:#a4a4be;cursor:pointer;font-size:14px">
                Cancelar
            </button>
            <button id="confirmAction" class="btn-danger" style="padding:8px 20px;border-radius:6px;border:none;background:#ef4444;color:white;cursor:pointer;font-size:14px;font-weight:500">
                Confirmar
            </button>
        </div>
    </div>
</div>

<!-- Estilos CSS para modales adaptativos -->
<style>
/* Estilos para modo oscuro (por defecto) */
.modal-content {
    background: #1e1e2a !important;
    border: 1px solid #2a2a3a !important;
}

.modal-header {
    border-bottom: 1px solid #2a2a3a !important;
}

.modal-title {
    color: #e7e7f7 !important;
}

.modal-close {
    color: #a4a4be !important;
}

.modal-footer {
    border-top: 1px solid #2a2a3a !important;
}

/* Estilos para modo claro */
body.light-mode .modal-content {
    background: white !important;
    border: 1px solid #e5e7eb !important;
}

body.light-mode .modal-header {
    border-bottom: 1px solid #e5e7eb !important;
}

body.light-mode .modal-title {
    color: #1f2937 !important;
}

body.light-mode .modal-close {
    color: #6b7280 !important;
}

body.light-mode .modal-footer {
    border-top: 1px solid #e5e7eb !important;
}

/* Estilos para campos de formulario en modo oscuro */
.modal .form-control {
    background: #2a2a3a !important;
    border: 1px solid #3a3a4a !important;
    color: #e7e7f7 !important;
}

.modal .form-control:focus {
    background: #2a2a3a !important;
    border-color: #6366f1 !important;
    color: #e7e7f7 !important;
}

.modal .form-label {
    color: #e7e7f7 !important;
}

/* Estilos para campos de formulario en modo claro */
body.light-mode .modal .form-control {
    background: white !important;
    border: 1px solid #d1d5db !important;
    color: #1f2937 !important;
}

body.light-mode .modal .form-control:focus {
    background: white !important;
    border-color: #6366f1 !important;
    color: #1f2937 !important;
}

body.light-mode .modal .form-label {
    color: #374151 !important;
}

/* Variables CSS para compatibilidad */
:root {
    --input-bg: #2a2a3a;
    --border: #3a3a4a;
    --text: #e7e7f7;
}

body.light-mode {
    --input-bg: white;
    --border: #d1d5db;
    --text: #1f2937;
}
</style>

<!-- Script para manejo de modales -->
<script th:inline="javascript">
    /*<![CDATA[*/
    
    // Función para abrir modal base
    function openModal(title, content, onSubmit) {
        const modal = document.getElementById('modalBase');
        modal.querySelector('.modal-title').innerHTML = title;
        modal.querySelector('.modal-body').innerHTML = content;
        
        const submitBtn = modal.querySelector('.modal-submit');
        submitBtn.style.display = onSubmit ? 'inline-block' : 'none';
        submitBtn.onclick = function() {
            if (onSubmit && typeof onSubmit === 'function') {
                onSubmit();
            } else {
                closeModal();
            }
        };
        
        modal.style.display = 'block';
        document.body.style.overflow = 'hidden';
    }
    
    // Función para cerrar modal base
    function closeModal() {
        document.getElementById('modalBase').style.display = 'none';
        document.body.style.overflow = 'auto';
    }
    
    // Función para abrir modal de confirmación
    function openConfirmModal(message, onConfirm) {
        const modal = document.getElementById('confirmModal');
        if (message) {
            modal.querySelector('p').textContent = message;
        }
        
        const confirmBtn = document.getElementById('confirmAction');
        confirmBtn.onclick = function() {
            if (onConfirm && typeof onConfirm === 'function') {
                onConfirm();
            }
            closeConfirmModal();
        };
        
        modal.style.display = 'block';
        document.body.style.overflow = 'hidden';
    }
    
    // Función para cerrar modal de confirmación
    function closeConfirmModal() {
        document.getElementById('confirmModal').style.display = 'none';
        document.body.style.overflow = 'auto';
    }
    
    // Cerrar modales al hacer clic fuera del contenido
    window.onclick = function(event) {
        const modals = document.querySelectorAll('.modal');
        modals.forEach(modal => {
            if (event.target === modal) {
                if (modal.id === 'modalBase') closeModal();
                if (modal.id === 'confirmModal') closeConfirmModal();
            }
        });
    };
    
    // Cerrar con ESC
    document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
            closeModal();
            closeConfirmModal();
        }
    });
    
    /*]]>*/
</script>

</body>
</html>